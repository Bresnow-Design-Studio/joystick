var n=(t="",e={})=>{throw new Error(`[joystick${t?`.${t}`:""}] ${e.message||e.reason||e}`)};var u=()=>typeof window=="undefined";var f=(t="")=>{try{let[e,r]=t?.split(".");return r?window?.joystick?._internal?.queues[e][r]:window?.joystick?._internal?.queues[e]}catch(e){n("addToQueue.getQueue",e)}},a=(t="",e=null)=>{try{u()||(f(t)||{}).array.push({callback:e})}catch(r){n("addToQueue",r)}};var p=t=>{try{return t instanceof Element}catch(e){n("types.isDOM",e)}};var s=t=>{try{return typeof t=="function"}catch(e){n("types.isFunction",e)}};var d=(t={})=>{try{return Object.entries(t).map(([e,r])=>{let[o,...i]=e.split(" ");return{type:o.toLowerCase(),selector:i.join(" "),handler:r}})}catch(e){n("component.events.serialize",e)}};var y=(t=16)=>{let e=[],r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];for(let o=0;o<t;o++)e.push(r[Math.floor(Math.random()*16)]);return e.join("")};var l=({componentId:t="",parentId:e="",element:r=null,eventType:o=null,eventListener:i=null})=>{try{r&&p(r)&&o&&i&&s(i)&&(r.addEventListener(o,i),window.joystick._internal.eventListeners.push({eventId:y(8),componentId:t,parentId:e,element:r,eventType:o,eventListener:i}))}catch(c){n("component.events.addListener",c)}};var h=(t=[],e={},r={})=>{try{t.forEach(o=>{l({componentId:r.id,parentId:r?.parent?.id,element:o,eventType:e.type,eventListener:function(c){Object.defineProperty(c,"target",{value:c.composedPath()[0]}),e.handler(c,r)}})})}catch(o){n("component.events.attachToDOM.attachEventListener",o)}},m=(t=[],e={})=>{try{t.forEach(r=>{a("eventListeners",()=>{let o=[...document.querySelectorAll(`[js-c="${e.id}"] ${r.selector}`)];o&&o.length>0&&h(o,r,e)})})}catch(r){n("component.events.attachToDOM.queueEventListeners",r)}},w=(t={})=>{try{if(t.lifecycle&&t.lifecycle.onBeforeUnmount&&s(t.lifecycle.onBeforeUnmount)){let e=function(){t.lifecycle.onBeforeUnmount(t)};window.removeEventListener("beforeunload",e),window.addEventListener("beforeunload",e)}}catch(e){n("component.events.attachToDOM.attachOnBeforeUnmount",e)}},$=(t={})=>{try{let e=d(t?.options?.events);w(t),m(e,t)}catch{n("component.events.attachToDOM")}};export{$ as default};

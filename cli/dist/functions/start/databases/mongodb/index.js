"use strict";var o=require("fs"),t=require("chalk"),e=require("util"),s=require("command-exists"),r=require("child_process");function n(o){return o&&"object"==typeof o&&"default"in o?o:{default:o}}var a=n(o),i=n(t),c=n(e),d=n(s),u=n(r);const l=c.default.promisify(u.default.exec),p=async()=>{d.default.sync("mongod")||(process.loader.stop(),console.warn(`\n  ${i.default.red("MongoDB is not installed on this computer.")}\n\n  ${i.default.green("Download MongoDB at https://www.mongodb.com/try/download/community")}\n    After you've installed MongoDB, run joystick start again, or, remove MongoDB from your databases list in your settings.development.json file to skip startup.\n  `),process.exit(1));a.default.existsSync(".joystick/data/mongodb")||a.default.mkdirSync(".joystick/data/mongodb",{recursive:!0});try{const{stdout:o}=await l(`mongod --port ${parseInt(process.env.PORT,10)+1} --dbpath ./.joystick/data/mongodb --quiet --fork --logpath ./.joystick/data/mongodb/log`);return((o=null)=>{const t=o&&o.match(/forked process:+\s[0-9]+/gi),e=t&&t[0]&&t[0].replace("forked process: ","");return e&&parseInt(e,10)})(o)}catch(o){console.warn(o),process.exit(1)}};module.exports=async(o={})=>await p();
